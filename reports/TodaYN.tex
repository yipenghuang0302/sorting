%\documentclass{article}
%\usepackage[utf8]{inputenc}
%\usepackage{amsmath}

%\title{Toda Lattice, Role of $N$ and $y_k$}
%\author{Lusa Zhan}
%\date{November 2016}

%\begin{document}

%\maketitle

\subsubsection{Role of $N$}
The choice of $N = \text{diag} (n, n-1, \dots, 1)$ for analog sorting is clarified by Theorem 1.5 in~\cite{helmke}. To summarize, the theorem states the following: 

For each $N$,  $\dot{H}(t) = [H,[H,N]]$ converges to an equilibrium $H_\infty$ as $t\rightarrow \infty$. If $N=\text{diag} (\mu_1 , \dots , \mu_n)$ where $\mu_1 > \dots > \mu_n$, then the Hessian of $f_N(H) = \frac{1}{2}\|N-H\|^2$ is nonsingular and negative definite. 

The linearization of the double bracket flow at an equilibrium point $H_\infty = \text{diag}(\lambda_{\pi(1)},\dots,\lambda_{\pi(n)})$ is 
\[\dot \xi_{ij} = -(\lambda_{\pi(i)}-\lambda_{\pi(j)})(\mu_i-\mu_j)\xi_{ij}\]
where $\xi = [H_\infty, N]$. Since the Hessian is negative definite, $\xi$ must be at its maximum. If $N = \text{diag} (n, n-1, \dots, 1)$, then $\xi$ will only reach its maximum if the diagonal entries of $H_\infty$ are sorted in descending order as well.

Thus the diagonal matrix $N$ determines the order of the diagonal entries in $H_\infty$. Letting $N = \text{diag}(n, ,n-1, \dots, 1)$, we will result in $x_1 \geq x_2 \geq \cdots \geq x_n$ in $H_\infty$.

\subsubsection{Role of off-diagonals $y_k$}
The choice of initial values for the off-diagonal $y_k$ values affects the results of analog sorting as well. 

First of all, as mentioned previously, $y_0=y_n=0$.
To analyze the initial values of $y_k$, consider the relation to $\dot x_k$
\begin{align*}
    \dot{x_k} &=  2y^2_k-2y^2_{k-1} \\
    \dot{y_k} &= y_k(x_{k+1}-x_k) 
\end{align*}

If $y_k=0$, then $\dot x_k=0$, meaning $x_k(t) = x_k(0)$ for all $t$. This means that the values along the diagonal of $H$ will remain constant and never get sorted. So, $y_k$ should be non-zero.

In addition, the $y_k$ values should be small (but still positive). Recall that the eigenvalues will be the values along the diagonal of $H$ as $t\rightarrow \infty$. Consider the determinant $f_n = \det (H-\lambda I)$, where $n$ is the size of the matrix. Since $H$ is a tridiagonal matrix, this determinant can be formulated using a recurrence relation on the size of the matrix $n$.

\begin{align*}
f_n &= (x_n-\lambda)f_{n-1}-y_{n-1}^2f_{n-2} \\
f_1 &= x_1-\lambda
\end{align*}

We can use this to calculate the first few $f_n$ and set them to $0$ (what we would do to calculate the eigenvalues):
\begin{align*}
f_1 &= x_1-\lambda = 0\\
f_2 &= (x_2-\lambda)(x_1-\lambda)-y_1^2 = 0\\
f_3 &= (x_3-\lambda)(x_2-\lambda)(x_1-\lambda)-(x_3-\lambda)y_1^2-(x_1-\lambda)y^2_2 = 0
\end{align*}

Intuitively, the eigenvalues will be closest to $x_k$ if the $y_k$ values are smaller. When setting up the analog sorter, we want the off-diagonals to be nonzero, but small enough to not significantly change the values to be sorted. 



%\section{Related work}
%Below is a list of articles that are related to this topic: 
%\begin{itemize}

%\item{
%    Brockett, R.w. ``Dynamical Systems That Sort Lists, Diagonalize Matrices, and Solve Linear Programming Problems.'' Linear Algebra and Its Applications 146 (1991): 79-91. }
%\item{
%    Helmke, Uwe, and John B. Moore. ``Double Bracket Isospectral Flows.'' Optimization and Dynamical Systems. London: Springer-Verlag, 1994. 43-80. Print.}
%\end{itemize}


%\end{document}
